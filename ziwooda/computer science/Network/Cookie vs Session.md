## HTTP의 특징

> _쿠키와 세션에 대해 파악하기 전에 먼저 HTTP의 특징을 파악하자_


🔥**Connectionless** : 클라이언트가 서버에 request를 보내고, 서버가 요청에 대한 응답을 보낸 후 연결을 끊어버리는 특징 (header의 `keep-alive` 값으로 connection 재활용)

🔥**Stateless** : 통신이 끝나면 상태를 유지하지 않는 특징

⇒ 상태 정보를 저장하기 위해 쿠키와 세션 사용

<br>

# Cookie

**_클라이언트 로컬에 저장되는, 키와 값이 들어있는 작은 데이터 파일_**
 
- 사용자 인증이 유효한 시간을 명시 → 유효시간 만료되면 브라우저는 종료되지만, 인증은 유지된다.
- 클라이언트의 상태 정보를 로컬에 저장하여 참조
- 클라이언트에 300개까지 저장 가능, 도메인당 20개의 값, 쿠키 하나당 4KB까지 저장 가능
- Response Header에 `Set-Cookie` 속성을 사용하면 클라이언트에 쿠키를 만들 수 있다.
- 사용자의 별도 요청 필요없이 브라우저의 request가 날라오면 Request Header를 넣어서 자동으로 서버에 전송할 수 있다.

<br>

## 쿠키 동작 방식

<img src="https://user-images.githubusercontent.com/70079416/236422600-4cbc4252-4221-492e-bcdd-b3baf8473e48.png" width="60%" height="60%" />

1. 클라이언트가 페이지를 요청
2. 서버는 쿠키를 생성하고, HTTP 헤더에 쿠키를 포함시켜 응답 전송
3. 쿠키 만료 기간에 맞게 클라이언트에서 쿠키 보관 (브라우저 종료와는 무관)
4. 같은 요청이 들어오면, HTTP 헤더에 쿠키를 함께 보냄
5. 서버는 그 쿠키를 읽고, 이전 상태 정보를 변경해야 하면 쿠키를 업데이트 + HTTP 헤더에 포함시켜 응답 전송

<br>

### 구성 요소

- 이름 : 쿠키 구별
- 값 : 쿠키 이름과 관련된 값
- 유효시간 (유지시간)
- 도메인 : 쿠키 전송 도메인
- 경로 : 쿠키 전송할 요청 경로

### 사용 예시

- 로그인 정보 저장 (’아이디와 비밀번호를 저장하시겠습니까?’) + 자동로그인
- 쇼핑몰의 장바구니
- 팝업창의 ‘일주일 간 이 창을 보지 않음’

<br>

# Session

**_쿠키를 기반으로 하지만, 사용자의 상태 정보를 서버에서 관리_**

- 서버가 클라이언트를 구분하기 위해 세션 ID를 부여하고, 브라우저를 종료할 때까지 인증상태 유지
    - 세션 ID : 클라이언트가 요청을 보내면, 해당 서버의 엔진이 클라이언트에 부여하는 고유값
- 사용자 정보를 서버에 저장하므로 보안은 더 좋지만, 사용자가 많아질수록 메모리 이슈가 생길 수 있다.
    - 동시 접속사가 많은 웹사이트의 경우, 서버 과부하로 성능 저하의 요인이 될 수 있다.
- 상태 정보를 서버에서 관리하므로 쿠키보다 보안 측면에서 우수
- 세션 정보를 서버에 저장하여 처리가 요구되므로 비교적 속도가 느림

<br>

## 세션 동작 방식

1. 클라이언트가 페이지를 요청
2. 서버는 클라이언트의 Request-Header에서 `Set-Cookie`값을 확인하고 session ID 확인
    1. 없으면 클라이언트에 session ID를 생성하여 제공
    2. 클라이언트는 이 session ID를 쿠키를 사용하여 저장하고 보관
3. 클라이언트가 서버에 요청을 보낼 때, 이 쿠키의 session ID를 함께 전달
4. 서버는 session ID를 전달 받아, 해당 세션의 클라이언트 정보를 가져와서 요청 처리

<br>

### 사용 예시

- 화면 이동 시에도 로그인이 유지되는 것

<br>

## Comparison Table

<img src="https://user-images.githubusercontent.com/70079416/236423133-ddbf7dc9-5cdb-4674-b305-9384dea1b9e7.png" width="60%" height="60%" />


<br>

**🥕 References**

[쿠키와 세션 개념](https://interconnection.tistory.com/74)